---
title: MFE tutorial 
nav_order: 4
parent: Guide
permalink: /docs/guide/mfe_tutorial/
layout: default
---

# MFE tutorial 

## What does MFE do? 

MFE (mean field energy) Calculates the mean field ionization energy on an ionizable residue at a specific pH/eH. MFE provides the energy interctions of ionized residues and its neighbors. 

## Files needed 
Files needed to run this tool is **fort.38, head3.lst, pK.out, and sum_crg.out** 

To create these files please look at [pKa calculation tutorial](https://gunnerlab.github.io/mcce4_tutorial/docs/tests/ex2/)

## Usage 

If you have succesfully installed the  [MCCE-Tools](https://github.com/GunnerLab/MCCE4-Tools) you should be able to call the tool from any directory. 

```
mfe.py –p 7 -c 0.05 LYS+A0001_

```

the -p flags defines at what pH the analysis is done. -c is at the energy cutoff that defines the energy minimum for residues interaction. 

## Output 

Output for the analysis should look like this for LysA1 in lysozyme : 


```
Residue HIS+A0015_ pKa/Em=6.178
=================================
Terms          pH     meV    Kcal
---------------------------------
vdw0        -0.03   -1.85   -0.04
vdw1        -0.19  -11.17   -0.26
tors         0.00    0.00    0.00
ebkb         1.93  111.93    2.63
dsol         1.36   78.80    1.85
offset      -0.73  -42.55   -1.00
pH&pK0       0.02    1.16    0.03
Eh&Em0       0.00    0.00    0.00
-TS          0.00    0.00    0.00
residues     0.37   21.44    0.50
*********************************
TOTAL        2.72  157.75    3.71  sum_crg
*********************************
LYSA0001_    0.17    9.78    0.23    0.99
GLUA0007_   -0.05   -3.11   -0.07   -1.00
LYSA0013_    0.07    4.06    0.10    1.00
ARGA0014_    0.33   19.19    0.45    1.00
ASPA0018_   -0.06   -3.59   -0.08   -1.00
SERA0085_    0.05    3.08    0.07    0.00
ASPA0087_   -1.03  -60.00   -1.41   -1.00
THRA0089_    0.47   27.19    0.64    0.00
ASNA0093_   -0.06   -3.46   -0.08    0.00
LYSA0096_    0.46   26.61    0.63    1.00
LYSA0097_    0.06    3.21    0.08    1.00
CTRA0129_   -0.08   -4.70   -0.11   -1.00
=================================

```

## Conversion of units
This output gives you the a varierity of the interactions of energy terms in differen units (pH, meV, kCal).

pH → energy (single proton):
	•	ΔE = k_B * T * ln(10) * ΔpH

pH → free energy (per mole):
	•	ΔG = 2.303 * R * T * ΔpH

At 298 K (room temp):

Energy in meV (single proton):
	•	ΔE(meV) ≈ 59.16 * ΔpH

Energy in kcal/mol:
	•	ΔG(kcal/mol) ≈ 1.364 * ΔpH

## Definitions of terms 

1) **Vdw0**: vdW interactions within the conformer (a side chain or ligand) + interaction with implicit solvent

2) **Vdw1**: vdw interaction of this conformer with the protein backbone

3) **tors**: torsion oenergy of the conformer

4) **dsol**: Loss of solvation energy compared with this conformer in solution. It should be positive as it is a loss in energy.

5) **offset**: energy term that can be freely modified

6) **pH&pK0**:  Solution pH effect on ionization. It is the environmental pressure on residue ionization. For an acid, low solution pH makes ionization (releasing a proton) easy, so it contributes favorable energy. For a base, low pH makes ionization harder. When pH equals the residue’s solution pKa, the environment pH is at a balance point, where the contribution is 0.

7) **Eh&Em0**: Environment Eh effect on redox reaction. This works similarly to pHpK0.

8) **-TS**: Entropy term.The number of rotamers of neutral and ionized residues generated by MCCE may differ. The effect of different rotamer counts on the two ionization states acts like entropy.

9) **residues**: Total pairwise interaction from other residues.
Other residues may shift the ionization free energy depending on their dipole orientation and charge.

10) **total**:Total pairwise interaction from other residues.

At the end of the file you can see the chose ionized residue interactions with its neighboring residues 
